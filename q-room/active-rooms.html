<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Q-Room | Active Rooms</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=JetBrains+Mono:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/active-rooms.css">
</head>
<body>
<div class="container">

  <div class="header">
    <div class="logo-wrap">
      <div class="logo">Q-ROOM</div>
      <div class="logo-tag">ACTIVE ROOMS</div>
    </div>
    <div class="status-row">
      <div class="dot" id="dot"></div>
      <div class="status-text" id="status-text">CONNECTING...</div>
      <div class="countdown-text" id="countdown-text"></div>
    </div>
  </div>

  <div class="error-box" id="error-box">
    <div class="error-title">❌ ERROR</div>
    <div class="error-msg" id="error-msg"></div>
  </div>

  <div class="summary-bar">
    <div class="summary-chip">
      <div class="chip-label">Active Rooms</div>
      <div class="chip-val loading-shimmer" id="chip-rooms" style="color:var(--cyan)">—</div>
    </div>
    <div class="summary-chip">
      <div class="chip-label">Players Online</div>
      <div class="chip-val loading-shimmer" id="chip-players" style="color:var(--green)">—</div>
    </div>
    <div class="summary-chip">
      <div class="chip-label">Last Updated</div>
      <div class="chip-val" id="chip-time" style="color:var(--muted);font-size:1rem;padding-top:4px;letter-spacing:0.05em">—:—:—</div>
    </div>
  </div>

  <div class="section-title">
    PLAYING
    <span class="section-count" id="playing-count">0</span>
    <span style="flex:1;height:1px;background:var(--border);display:block"></span>
  </div>
  <div class="rooms-list" id="rooms-active">
    <div class="empty"><div class="empty-icon">🎮</div><div class="empty-text loading-shimmer">読み込み中...</div></div>
  </div>

  <div style="margin-top:32px;">
    <button class="finished-toggle" id="fin-toggle" onclick="toggleFinished()">▶ 終了済みルームを表示</button>
    <div class="rooms-list" id="rooms-finished" style="display:none"></div>
  </div>

  <div class="footer">
    Q-Room Active Rooms &nbsp;·&nbsp; 60秒ごとに自動更新<br>
    <a href="https://astro-root.com/q-room/" target="_blank">Q-Roomで遊ぶ</a>
    &nbsp;·&nbsp;
    <a href="https://console.firebase.google.com/project/q-room-fe8a6/database" target="_blank">Firebase Console</a>
  </div>

</div>

<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>

<!-- SITE GATE -->
<div class="gate-overlay" id="gate-overlay">
  <div class="gate-box">
    <div class="gate-logo">Q-ROOM</div>
    <div class="gate-sub">ACTIVE ROOMS · RESTRICTED</div>
    <input class="gate-input" id="gate-input" type="password" placeholder="パスワードを入力"
      onkeydown="if(event.key==='Enter')submitGate()">
    <div class="gate-error" id="gate-error"></div>
    <button class="gate-btn" onclick="submitGate()">→ アクセス</button>
  </div>
</div>

<!-- ADMIN PEEK PANEL -->
<div class="peek-overlay" id="peek-overlay" onclick="closePeek()"></div>
<div class="peek-drawer" id="peek-drawer">
  <div class="peek-header">
    <div>
      <div class="peek-title">👁 ADMIN PEEK</div>
      <div class="peek-rid" id="peek-rid">—</div>
    </div>
    <button class="peek-close" onclick="closePeek()">✕</button>
  </div>
  <div class="peek-body" id="peek-body">
    <div style="text-align:center;padding:40px;color:var(--muted);font-family:var(--mono);font-size:0.82rem;">読み込み中...</div>
  </div>
  <div class="peek-footer">READ-ONLY · Firebase への書き込みなし · 他のプレイヤーには見えません</div>
</div>

<script src="js/active-rooms.js"></script>
</body>
</html>
